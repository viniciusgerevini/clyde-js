(this["webpackJsonpclyde-editor"]=this["webpackJsonpclyde-editor"]||[]).push([[0],{44:function(e,n,t){},45:function(e,n,t){},76:function(e,n,t){"use strict";t.r(n);var r,a=t(1),i=t.n(a),o=t(20),c=t.n(o),l=(t(44),t(45),t(3)),u=t(6),s=t(7),d=t(22),b=t(34),f=t.n(b),h=t(10),g=t(2),v=Object(s.b)("editor/interface/toggle_editor"),p=Object(s.b)("editor/interface/toggle_intepreter"),j=Object(s.b)("editor/interface/change_interpreter_split_direction");var x,O=Object(s.c)({isEditorEnabled:!0,isInterpreterEnabled:!0,interpreterSplitDirection:"vertical"},(r={},Object(g.a)(r,v,(function(e,n){return e.isEditorEnabled=n.payload.state,e})),Object(g.a)(r,p,(function(e,n){return e.isInterpreterEnabled=n.payload.state,e})),Object(g.a)(r,j,(function(e,n){return e.interpreterSplitDirection=n.payload.direction,e})),r)),m=Object(s.b)("editor/editor/set_document_content"),k=Object(s.b)("editor/editor/update_preference");var y,w=Object(s.c)({currentValue:"",preferences:{theme:"dracula",fontSize:16,tabSize:4,highlightActiveLine:!1,lineWrap:!1,useSoftTabs:!0,showInvisibles:!1,scrollPastEnd:!1,vimMode:!1}},(x={},Object(g.a)(x,m,(function(e,n){return e.currentValue=n.payload,e})),Object(g.a)(x,k,(function(e,n){return e.preferences[n.payload.name]=n.payload.value,e})),x)),E=t(13),_=Object(s.b)("editor/interpreter/set_dialogue_block"),S=Object(s.b)("editor/interpreter/add_dialogue_line"),D=Object(s.b)("editor/interpreter/clear_timeline"),I=Object(s.b)("editor/interpreter/show_metadata"),T=Object(s.b)("editor/interpreter/hide_metadata"),C=Object(s.b)("editor/interpreter/show_debug_pane"),A=Object(s.b)("editor/interpreter/hide_debug_pane"),P=Object(s.b)("editor/interpreter/enable_single_bubble_dialogue"),N=Object(s.b)("editor/interpreter/disable_single_bubble_dialogue"),B=Object(s.b)("editor/interpreter/choose_option"),V=Object(s.b)("editor/interpreter/notify_event"),L=Object(s.b)("editor/interpreter/clear_events");var M,z,R,G,F=Object(s.c)({currentBlock:void 0,timeline:[],shouldShowExtraMetadata:!1,shouldShowDebugPane:!1,singleBubblePresentation:!1,document:void 0,events:[]},(y={},Object(g.a)(y,_,(function(e,n){return e.currentBlock=n.payload,e})),Object(g.a)(y,S,(function(e,n){return e.timeline=[].concat(Object(E.a)(e.timeline),[n.payload]),e})),Object(g.a)(y,D,(function(e,n){return e.timeline=[],e})),Object(g.a)(y,I,(function(e){return e.shouldShowExtraMetadata=!0,e})),Object(g.a)(y,T,(function(e){return e.shouldShowExtraMetadata=!1,e})),Object(g.a)(y,C,(function(e){return e.shouldShowDebugPane=!0,e})),Object(g.a)(y,A,(function(e){return e.shouldShowDebugPane=!1,e})),Object(g.a)(y,P,(function(e){return e.singleBubblePresentation=!0,e})),Object(g.a)(y,N,(function(e){return e.singleBubblePresentation=!1,e})),Object(g.a)(y,B,(function(e,n){return e.timeline.length&&"options"===e.timeline[e.timeline.length-1].type?(e.timeline[e.timeline.length-1].selected=n.payload,e):e})),Object(g.a)(y,V,(function(e,n){return e.events=[].concat(Object(E.a)(e.events),[n.payload]),e})),Object(g.a)(y,L,(function(e,n){return e.events=[],e})),y)),H=Object(h.b)({interfaceConfig:O,editor:w,interpreter:F}),U=t(16),q=t(4),Z=t(9),$=t(8),W=t(0),K=q.a.div(M||(M=Object(l.a)(["\n  display: flex;\n  align-items: stretch;\n  flex-grow: 1;\n  height: auto;\n  flex-direction: ",";\n  max-height: 100%;\n"])),(function(e){return"horizontal"===e.direction?"column":"row"})),J=q.a.div(z||(z=Object(l.a)(["\n  background-color: #eee;\n  background-repeat: no-repeat;\n  background-position: 50%;\n  flex-basis: ","px;\n  cursor: ",";\n"])),4,(function(e){return"horizontal"===e.direction?"row-resize":"col-resize"}));function Y(e){var n=e.direction,t=void 0===n?"vertical":n,r=e.defaultSizes,a=e.style,o=Array.isArray(e.children)?e.children:[e.children],c=o.filter((function(e){return e&&""!==e})),l=function(){if(1===c.length)return["100%"];if(r){var e=r.map((function(e){return"calc(".concat(e,"% - 2px)")}));if(r.length===c.length)return e;var n=c.reduce((function(e,n){var t=o.indexOf(n);return e+r[t]}),0);if(n<100){var t=o.indexOf(c[c.length-1]);e[t]="calc(".concat(r[t]+(100-n),"% - 2px)")}return e}var a=Math.floor(100/c.length);return Array(o.length).fill("calc(".concat(a,"% - 2px)"))}(),u=o.reduce((function(e,n,r){if(!n)return e;var a=c.indexOf(n);return a>0&&a<c.length&&e.push(Object(W.jsx)(J,{direction:t})),e.push(i.a.cloneElement(n,{key:r,style:{flexBasis:l[r],flexGrow:1}})),e}),[]);return Object(W.jsx)(K,{direction:t,style:a,children:u.map((function(e,n){return i.a.cloneElement(e,{key:n})}))})}var Q=q.a.div(R||(R=Object(l.a)(["\n  position: absolute;\n  display: 'flex';\n  flex-direction: column;\n  width: auto;\n  min-width: 230px;\n  z-index: 9999;\n  background-color: #fff;\n  font-size: 1rem;\n  padding: 10px 0px;\n  border: 1px solid #eee;\n  border-radius: 5px;\n"]))),X=q.a.div(G||(G=Object(l.a)(["\n  padding: 6px 15px;\n  display: flex;\n  flex-direction: row;\n\n  &:hover {\n    background-color: #eee;\n  }\n\n  > svg {\n    flex-basis: 30px;\n    margin-right: 5px;\n  }\n"])));function ee(e){var n=e.children,t=e.onClick,r=e.style;return Object(W.jsx)(Q,{onClick:t,style:r,children:i.a.Children.toArray(n)})}function ne(e){var n=e.label,t=e.icon,r=e.onClick,a=e.text;return Object(W.jsxs)(X,{"aria-label":n,onClick:r,children:[Object(W.jsx)(Z.a,{icon:t})," ",a]})}var te=t(14),re=t(38),ae=t.n(re),ie=t(39);t(70),t(71),t(72),t(73),t(74),t(75);function oe(){var e=[{token:"constant.language.boolean",regex:/(true|false)/},{token:"constant.numeric",regex:/[0-9,.]+/},{token:"constant.string",regex:/(".*")/}],n=[{token:"keyword.operator",regex:/(isnt|ISNT)/},{token:"keyword.operator",regex:/(and|or|not|is|AND|OR|NOT|IS)/},{token:"keyword.operator",regex:/(&&|\|\||<=|>=|==|!=)/},{token:"keyword.operator",regex:/(\*|\+|-|\^|\/|%|<|>|!)/}],t=[{token:"keyword",regex:/(\})/,next:"start"}],r=[{token:"support.constant",regex:/OPTIONS_COUNT/}],a=[{token:"identifier",regex:/[a-zA-Z_][a-zA-Z0-9_]+/}];this.$rules={start:[{token:"comment",regex:/^\s*--.*$/},{token:["keyword","text","variable"],regex:/^(==)(\s*)([a-zA-Z0-9_ ]+)$/},{token:["text","keyword","text","support.constant"],regex:/(\s*)(->)(\s*)(END)$/},{token:["text","keyword","text","variable"],regex:/(\s*)(->)(\s*)([a-zA-Z0-9_ ]+)/},{token:["text","keyword","text"],regex:/(\s*)(<-)(\s*)/},{token:["text","keyword","text","support.constant"],regex:/^(\s*)(\()(\s*)((?:shuffle|once|sequence|shuffle once|shuffle sequence)*)$/},{token:["text","keyword"],regex:/^(\s*)(\))$/},{token:"keyword.control",regex:/^(\s*[*+>])/},{token:"keyword",regex:/(\{)/,next:"logicBlock"},{token:"constant.string",regex:/#[a-zA-Z0-9_]+/},{token:["variable","text","variable"],regex:/((?:\s*[a-zA-Z0-9_] +:)?\s*)(".*")((?:\$[a-zA-Z0-9_]+)?)/},{token:["variable","text","variable"],regex:/((?:\s*[a-zA-Z0-9_ ]+:)?\s*)([^\r\n#${]+)((?:\$[a-zA-Z0-9_]+)?)/}],logicBlock:[{token:"keyword.control",regex:/(set)/,next:"assignmentBlock"},{token:"keyword.control",regex:/(trigger)/,next:"eventBlock"},{token:"keyword.control",regex:/(when)/}].concat(r,n,e,a,t),assignmentBlock:[].concat(r,n,[{token:"keyword.operator",regex:/(\+=|-=|\*=|\/=|%=|\^=)/},{token:"keyword.operator",regex:/(=)/}],e,a,t),eventBlock:[].concat(a,t)},this.normalizeRules()}var ce,le=["defaultValue","setDocumentContent","notifyChange","preferences"],ue=q.a.div(ce||(ce=Object(l.a)(["\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n"]))),se={theme:"dracula",fontSize:16,tabSize:4,highlightActiveLine:!1,lineWrap:!1,useSoftTabs:!0,showInvisibles:!1,scrollPastEnd:!1};function de(e){var n=e.defaultValue,t=e.setDocumentContent,r=e.notifyChange,a=e.preferences,i=void 0===a?se:a,o=Object(te.a)(e,le),c=Object(ie.a)(),l=c.ref,s=c.width,d=void 0===s?500:s,b=c.height,f=void 0===b?500:b;return Object(W.jsx)(ue,Object(u.a)(Object(u.a)({ref:l},o),{},{"aria-label":"Text editor",children:Object(W.jsx)(ae.a,{defaultValue:n,mode:"clyde",theme:i.theme,onBeforeLoad:function(e){var n;(n=e).define("ace/mode/clyde_highlight_rules",["require","exports","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,n){var t=e("ace/lib/oop"),r=e("ace/mode/text_highlight_rules").TextHighlightRules;t.inherits(oe,r),n.ClydeHighlightRules=oe})),n.define("ace/mode/clyde",["require","exports","ace/lib/oop","ace/mode/text","ace/mode/clyde_highlight_rules"],(function(e,n){var t=e("ace/lib/oop"),r=e("ace/mode/text").Mode,a=e("ace/mode/clyde_highlight_rules").ClydeHighlightRules,i=function(){this.$id="ace/mode/clyde",this.HighlightRules=a,this.lineCommentStart="--",this.getNextLineIndent=function(e,n,t){var r=this.$getIndent(n),a=this.getTokenizer().getLineTokens(n,e).tokens;return a.length&&"comment"===a[a.length-1].type||"start"===e&&n.match(/^\s*(\(|\*|\+)/)&&(r+=t),r}};t.inherits(i,r),n.Mode=i}))},onChange:function(e){t(e),e!==n&&r({text:"<DIALOGUE_CHANGED>"})},name:"mainEditor",width:"".concat(d,"px"),height:"".concat(f,"px"),editorProps:{$blockScrolling:!0},fontSize:i.fontSize,tabSize:i.tabSize,debounceChangePeriod:1e3,keyboardHandler:i.vimMode?"vim":void 0,highlightActiveLine:i.highlightActiveLine,setOptions:{showPrintMargin:!1,wrapBehavioursEnabled:i.lineWrap,wrap:i.lineWrap,useSoftTabs:i.useSoftTabs,showInvisibles:i.showInvisibles,scrollPastEnd:i.scrollPastEnd,navigateWithinSoftTabs:!0}})}))}var be=function(e){var n={equal:function(e){return o(e.elements[0])===o(e.elements[1])},not_equal:function(e){return o(e.elements[0])!==o(e.elements[1])},greater_than:function(e){return o(e.elements[0])>o(e.elements[1])},greater_or_equal:function(e){return o(e.elements[0])>=o(e.elements[1])},less_than:function(e){return o(e.elements[0])<o(e.elements[1])},less_or_equal:function(e){return o(e.elements[0])<=o(e.elements[1])},and:function(e){return c(e.elements[0])&&c(e.elements[1])},or:function(e){return c(e.elements[0])||c(e.elements[1])},not:function(e){return!c(e.elements[0])},mult:function(e){return o(e.elements[0])*o(e.elements[1])},div:function(e){return o(e.elements[0])/o(e.elements[1])},sub:function(e){return o(e.elements[0])-o(e.elements[1])},add:function(e){return o(e.elements[0])+o(e.elements[1])},pow:function(e){return Math.pow(o(e.elements[0]),o(e.elements[1]))},mod:function(e){return o(e.elements[0])%o(e.elements[1])},error:function(e){throw new Error('Unknown expression "'.concat(e.name,'"'))}},t={expression:function(e){return l(e)},variable:function(e){return u(e)},error:function(e){throw new Error('Unknown condition type "'.concat(e.type,'"'))}},r={assign:function(n,t){return e.setVariable(n,t)},assign_sum:function(n,t){return e.setVariable(n,e.getVariable(n)+t)},assign_sub:function(n,t){return e.setVariable(n,e.getVariable(n)-t)},assign_mult:function(n,t){return e.setVariable(n,e.getVariable(n)*t)},assign_div:function(n,t){return e.setVariable(n,e.getVariable(n)/t)},assign_pow:function(n,t){return e.setVariable(n,Math.pow(e.getVariable(n),t))},assign_mod:function(n,t){return e.setVariable(n,e.getVariable(n)%t)},error:function(e,n,t){throw new Error('Unknown operation "'.concat(t.operation,'"'))}},a={literal:function(e){return e.value},variable:function(n){return e.getVariable(n.name)},assignment:function(e){return i(e)},expression:function(e){return l(e)},error:function(e){throw new Error('Unknown node "'.concat(e.type,'"'))}},i=function(e){var n=e.variable,t=e.value,a=o(t);return(r[e.operation]||r.error)(n.name,a,e)},o=function(e){return(a[e.type]||a.error)(e)},c=function(e){return(t[e.type]||t.error)(e)},l=function(e){return(n[e.name]||n.error)(e)},u=function(n){return e.getVariable(n.name)};return{checkCondition:c,handleAssignement:i,SPECIAL_VARIABLE_NAMES:["OPTIONS_COUNT"]}},fe=["OPTIONS_COUNT"];function he(e,n){var t=n||{access:{},variables:{},internal:{}};return{setAsAccessed:function(e){t.access[e]=!0},wasAlreadyAccessed:function(e){return!!t.access[e]},getVariable:function(e,n){if(fe.includes(e))return this.getInternalVariable(e,n);var r=t.variables[e];return void 0===r?n:r},setVariable:function(n,r){return e.triggerEvent(e.events.VARIABLE_CHANGED,{name:n,value:r,previousValue:t.variables[n]}),t.variables[n]=r},setInternalVariable:function(e,n){return t.internal[e]=n},getInternalVariable:function(e,n){var r=t.internal[e];return void 0===r?n:r},getAll:function(){return t},load:function(e){t=e},clear:function(){t={access:{},variables:{},internal:{}}}}}var ge,ve={VARIABLE_CHANGED:"variable_changed",EVENT_TRIGGERED:"event_triggered"};function pe(){var e,n=(e={},Object(g.a)(e,ve.VARIABLE_CHANGED,[]),Object(g.a)(e,ve.EVENT_TRIGGERED,[]),e);return{events:ve,triggerEvent:function(e,t){n[e].forEach((function(e){return e(t)}))},addListener:function(e,t){return n[e].push(t),t},removeListener:function(e,t){var r=n[e].indexOf(t);if(-1===r)throw new Error("Listener not defined");n[e].splice(r,1)}}}var je="TEXT",xe="INDENT",Oe="DEDENT",me="OPTION",ke="STICKY_OPTION",ye="FALLBACK_OPTION",we="BRACKET_OPEN",Ee="BRACKET_CLOSE",_e="EOF",Se="SPEAKER",De="LINE_ID",Ie="TAG",Te="BLOCK",Ce="DIVERT",Ae="DIVERT_PARENT",Pe="VARIATIONS_MODE",Ne="-",Be="+",Ve="*",Le="/",Me="^",ze="%",Re="{",Ge="}",Fe="AND",He="OR",Ue="NOT",qe="==, is",Ze="!=, isnt",$e=">=",We="<=",Ke="GREATER",Je="LESS",Ye="number",Qe="null",Xe="boolean",en="string",nn="identifier",tn="set",rn="trigger",an="when",on="=",cn="+=",ln="-=",un="/=",sn="*=",dn="^=",bn="%=",fn=",",hn="line break",gn="DEFAULT",vn="OPTION",pn="QSTRING",jn="LOGIC",xn="VARIATIONS",On=(ge={},Object(g.a)(ge,je,"text"),Object(g.a)(ge,xe,"INDENT"),Object(g.a)(ge,Oe,"DEDENT"),Object(g.a)(ge,me,"*"),Object(g.a)(ge,ke,"+"),Object(g.a)(ge,ye,">"),Object(g.a)(ge,we,"("),Object(g.a)(ge,Ee,")"),Object(g.a)(ge,_e,"EOF"),Object(g.a)(ge,Se,"<speaker name>:"),Object(g.a)(ge,De,"$id"),Object(g.a)(ge,Ie,"#tag"),Object(g.a)(ge,Te,"== <block name>"),Object(g.a)(ge,Ce,"-> <target name>"),Object(g.a)(ge,Ae,"<-"),Object(g.a)(ge,Pe,"<variations mode>"),Object(g.a)(ge,Re,"{"),Object(g.a)(ge,Ge,"}"),Object(g.a)(ge,Fe,"&&, and"),Object(g.a)(ge,He,"||, or"),Object(g.a)(ge,Ue," not, !"),Object(g.a)(ge,qe,"==, is"),Object(g.a)(ge,Ze,"!=, isnt"),Object(g.a)(ge,$e,">="),Object(g.a)(ge,We,"<="),Object(g.a)(ge,Ke,">"),Object(g.a)(ge,Je,"<"),ge);function mn(e){var n=On[e];return n||e}function kn(e){var n=[0],t=0,r=0,a=0,i=e.length,o=[],c=[gn],l=null,u=function(e){c.unshift(e)},s=function(){c.length>1&&c.shift()},d=function(e){return c[0]===e},b=function(e,n,t){return e.slice(n,n+t.length)===t},f=function(){for(var n=r,i=a,o=[];t<e.length;){var c=e[t];if(c===l)break;"\\"!==c||e[t+1]!==l?(o.push(c),t+=1,a+=1):(o.push(e[t+1]),t+=2,a+=2)}return yn(je,n,i,o.join("").trim())},h={"*":me,"+":ke,">":ye},g=["is","isnt","or","and","not","true","false","null","set","trigger","when"],v=function(e,n){switch(e.toLowerCase()){case"not":return yn(Ue,r,n);case"and":return yn(Fe,r,n);case"or":return yn(He,r,n);case"is":return yn(qe,r,n);case"isnt":return yn(Ze,r,n);case"true":case"false":return yn(Xe,r,n,e);case"null":return yn(Qe,r,n);case"set":return yn(tn,r,n);case"trigger":return yn(rn,r,n);case"when":return yn(an,r,n)}},p=function(e,n){var i=a;return a+=n,t+=n,yn(e,r,i)},j=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=a;return a+=n,t+=n,yn(e,r,i)},x=function(){return'"'===e[t]||"'"==e[t]?(null===l&&(l=e[t]),function(){var e=a;a+=1,t+=1;var n=f();return a+=1,t+=1,n.token=en,n.column=e,n}()):"}"===e[t]?function(){var e=a;a+=1,t+=1,s();var n=yn(Ge,r,e),i=O();return i?[n,i]:n}():b(e,t,"==")?p(qe,2):b(e,t,"!=")?p(Ze,2):b(e,t,"&&")?p(Fe,2):b(e,t,"||")?p(He,2):b(e,t,"<=")?p(We,2):b(e,t,">=")?p($e,2):b(e,t,"<")?p(Je,1):b(e,t,">")?p(Ke,1):"="===e[t]?j(on):b(e,t,"-=")?j(ln,2):b(e,t,"+=")?j(cn,2):b(e,t,"*=")?j(sn,2):b(e,t,"/=")?j(un,2):b(e,t,"^=")?j(dn,2):b(e,t,"%=")?j(bn,2):"+"===e[t]?j(Be,1):"-"===e[t]?j(Ne,1):"*"===e[t]?j(Ve,1):"/"===e[t]?j(Le,1):"^"===e[t]?j(Me,1):"%"===e[t]?j(ze,1):","===e[t]?j(fn,1):"!"===e[t]?function(){var e=a;return a+=1,t+=1,yn(Ue,r,e)}():e[t].match(/[0-9]/)?function(){for(var n=a,i="";e[t]&&e[t].match(/[0-9|.]/);)i+=e[t],t+=1,a+=1;return yn(Ye,r,n,i)}():e[t].match(/[A-Za-z]/)?function(){for(var n=a,i="";e[t]&&e[t].match(/[A-Z|a-z|0-9|_]/);)i+=e[t],t+=1,a+=1;return g.includes(i.toLowerCase())?v(i,n):yn(nn,r,n,i.trim())}():void 0},O=function(){for(var n=t,i=a;" "===e[n];)n+=1,i+=1;if("\n"===e[n])return yn(hn,r,i)},m=function(){for(var n=t-2;" "===e[n];)n-=1;if("\n"===e[n])return yn(hn,r,0)};function k(){if(!d(pn)&&"-"===e[t]&&"-"===e[t+1])return function(){for(;e[t]&&"\n"!==e[t];)t+=1;t+=1,r+=1}();if(!d(pn)&&"\n"===e[t])return function(){for(;"\n"===e[t];)r+=1,t+=1,a=0;d(vn)&&s()}();if(!d(jn)&&(0===a&&e[t].match(/[\t ]/)||0===a&&n.length>1))return function(){for(var i=r,o=0;e[t]&&e[t].match(/[\t ]/);)o+=1,t+=1;if(o>n[0]){var c=n[0];return a+=o,n.unshift(o),yn(xe,i,c)}if(o!==n[0]){for(var l=[];o<n[0];)n.shift(),a=n[0],l.push(yn(Oe,r,a));return l}a=n[0]}();if(!d(pn)&&"{"===e[t])return function(){var e=a;a+=1,t+=1,u(jn);var n=yn(Re,r,e),i=m();return i?[i,n]:n}();if(d(jn)){var i=x();if(i)return i}return'"'!==e[t]&&"'"!==e[t]||(null===l&&(l=e[t]),e[t]!==l)?d(pn)?f():" "===e[t]?function(){for(;" "===e[t];)t+=1,a+=1}():"("===e[t]?function(){var n=a,i=[];for(a+=1,t+=1,u(xn);e[t]&&e[t].match(/[A-Z|a-z| ]/);)i.push(e[t]),t+=1,a+=1;var o=[yn(we,r,n)],c=i.join("").trim();return c.length&&o.push(yn(Pe,r,n+2,c)),o}():")"===e[t]?function(){var e=a;return a+=1,t+=1,s(),yn(Ee,r,e)}():0===a&&"="===e[t]&&"="===e[t+1]?function(){var n=a,i=[];for(t+=2,a+=2;e[t]&&e[t].match(/[A-Z|a-z|0-9|_| ]/);)i.push(e[t]),t+=1,a+=1;return yn(Te,r,n,i.join("").trim())}():"-"===e[t]&&">"===e[t+1]?function(){var n=a,i=[];for(t+=2,a+=2;e[t]&&e[t].match(/[A-Z|a-z|0-9|_| ]/);)i.push(e[t]),t+=1,a+=1;var o=yn(Ce,r,n,i.join("").trim()),c=O();return c?[o,c]:o}():"<"===e[t]&&"-"===e[t+1]?function(){var e=a;t+=2,a+=2;var n=yn(Ae,r,e),i=O();return i?[n,i]:n}():d(xn)&&"-"===e[t]?function(){var e=a;return a+=1,t+=1,yn(Ne,r,e)}():"*"===e[t]||"+"===e[t]||">"===e[t]?function(){var n=h[e[t]],i=a;return a+=1,t+=1,u(vn),yn(n,r,i)}():d(vn)&&"="===e[t]?function(){var e=a;return a+=1,t+=1,yn(on,r,e)}():"$"===e[t]?function(){var n=a,i=[];for(t+=1,a+=1;e[t]&&e[t].match(/[A-Z|a-z|0-9|_]/);)i.push(e[t]),t+=1,a+=1;return yn(De,r,n,i.join(""))}():"#"===e[t]?function(){var n=a,i=[];for(t+=1,a+=1;e[t]&&e[t].match(/[A-Z|a-z|0-9|_]/);)i.push(e[t]),t+=1,a+=1;return yn(Ie,r,n,i.join(""))}():function(){for(var n=r,i=a,o=[];t<e.length;){var c=e[t];if(["\n","$","#","{"].includes(c))break;if("\\"!==c||"n"===e[t+1]){if(":"===c)return t+=1,a+=1,yn(Se,n,i,o.join("").trim());o.push(c),t+=1,a+=1}else o.push(e[t+1]),t+=2,a+=2}return yn(je,n,i,o.join("").trim())}():(a+=1,t+=1,void(d(pn)?(l=null,s()):u(pn)))}return{getAll:function(){for(var e=[];t<i;){var n=k();n&&(Array.isArray(n)?e=e.concat(n):e.push(n))}return t+=1,e.push(yn(_e,r,a)),e},next:function(){if(o.length)return o.shift();for(;t<i;){var e=k();if(e)return Array.isArray(e)?(o=e).shift():e}return t===i?(t+=1,yn(_e,r,a)):void 0}}}function yn(e,n,t,r){return{token:e,value:r,line:n,column:t}}var wn,En,_n,Sn,Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{type:"document",content:e,blocks:n}},In=function(e){return{type:"content",content:e}},Tn=function(e,n,t,r){return{type:"line",value:e,speaker:n,id:t,tags:r}},Cn=function(e){return"END"===e&&(e="<end>"),{type:"divert",target:e}},An=function(e){return{type:"variable",name:e}},Pn=function(e,n){return{type:"literal",name:e,value:n}},Nn=function(e,n){return{type:"conditional_content",conditions:e,content:n}},Bn=function(e,n){return{type:"action_content",action:e,content:n}},Vn=function(e,n){return{type:"expression",name:e,elements:n}},Ln=function(e,n,t){return{type:"assignment",variable:e,operation:n,value:t}},Mn=function(e){return{type:"event",name:e}},zn=["sequence","once","cycle","shuffle","shuffle sequence","shuffle once","shuffle cycle"],Rn=(wn={},Object(g.a)(wn,Fe,{precedence:1,associative:"LEFT"}),Object(g.a)(wn,He,{precedence:1,associative:"LEFT"}),Object(g.a)(wn,qe,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,Ze,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,Ke,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,Je,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,$e,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,We,{precedence:2,associative:"LEFT"}),Object(g.a)(wn,Be,{precedence:3,associative:"LEFT"}),Object(g.a)(wn,Ne,{precedence:3,associative:"LEFT"}),Object(g.a)(wn,ze,{precedence:4,associative:"LEFT"}),Object(g.a)(wn,Ve,{precedence:5,associative:"LEFT"}),Object(g.a)(wn,Le,{precedence:5,associative:"LEFT"}),Object(g.a)(wn,Me,{precedence:7,associative:"RIGHT"}),wn),Gn=(En={},Object(g.a)(En,on,"assign"),Object(g.a)(En,cn,"assign_sum"),Object(g.a)(En,ln,"assign_sub"),Object(g.a)(En,sn,"assign_mult"),Object(g.a)(En,un,"assign_div"),Object(g.a)(En,dn,"assign_pow"),Object(g.a)(En,bn,"assign_mod"),En);function Fn(e){var n,t,r=kn(e),a=[],i=!0,o=function(e,n){throw new Error('Unexpected token "'.concat(mn(e.token),'" on line ').concat(e.line+1," column ").concat(e.column+1,". Expected ").concat(n.map(mn).join(", ")," "))},c=function(e){a.length||a.push(r.next());var n=a.shift();return!e||n&&e.includes(n.token)||o(n,e),t=n},l=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a.length<n+1;){var t=r.next();if(!t)break;a.push(t)}var i=a[n];if(!e||i&&e.includes(i.token))return i},u=function e(){c([Te]);for(var n,r,a=[(n=t.value,r=In(s()),{type:"block",name:n,content:r})];l([Te]);)a=a.concat(e());return a},s=function e(){var n,t=[Se,je,me,ke,ye,Ce,Ae,we,Re,hn],r=l(t);if(!r)return[];switch(r.token){case Se:case je:c([Se,je]);var a=d();l([Re])?(c([Re]),n=[_(a)]):n=[a];break;case me:case ke:case ye:n=[x()];break;case Ce:case Ae:n=[y()];break;case we:c([we]),n=[w()];break;case hn:c([hn]);case Re:c([Re]),l([tn,rn])?n=[_()]:(l([an])&&c([an]),n=[C()])}return l(t)&&(n=n.concat(e())),n},d=function(){return b()},b=function(){switch(t.token){case Se:return f();case je:return h()}},f=function(){var e=t.value;c([je]);var n=b();return n.speaker=e,n},h=function e(){var n,r=t.value;if(l([De,Ie])?(c([De,Ie]),(n=v()).value=r):n=Tn(r),i&&l([xe]))if(c([xe]),l([me,ke,ye])){var a=x();a.id=n.id,a.name=n.value,a.tags=n.tags,n=a}else{for(;!l([Oe,_e]);){c([je]);var o=e();n.value+=" ".concat(o.value),o.id&&(n.id=o.id),o.tags&&(n.tags=o.tags)}c([Oe,_e])}return n},v=function(){switch(t.token){case De:return p();case Ie:return j()}},p=function(){var e=t.value;if(l([Ie])){c([Ie]);var n=j();return n.id=e,n}return Tn(void 0,void 0,e)},j=function(){var e=t.value;if(l([De,Ie])){c([De,Ie]);var n=v();return n.tags||(n.tags=[]),n.tags.unshift(e),n}return Tn(void 0,void 0,void 0,[e])},x=function(){for(var e,n,t,r,a={type:"options",name:e,content:[],id:n,speaker:t,tags:r};l([me,ke,ye]);)a.content.push(m());return l([Oe])&&c([Oe]),a},O=(n={},Object(g.a)(n,me,"once"),Object(g.a)(n,ke,"sticky"),Object(g.a)(n,ye,"fallback"),n),m=function(){c([me,ke,ye]);var e,n,r,a=O[t.token],o=[Se,je,xe,on,Re],u=[],b=!1;if(c(o),t.token===on&&(b=!0,c(o)),t.token===Re){var f=k();n=f.root,r=f.wrapper,c(o)}switch(t.token){case Se:case je:i=!1,e=d(),i=!0,b&&u.push(e)}if(l([Re])){c([Re]);var h=k();n?(r.content=h.wrapper,r=h.wrapper):(n=h.root,r=h.wrapper),c([hn])}(t.token===xe||l([xe]))&&(t.token!==xe&&c([xe]),u=u.concat(s()),e||(e=u[0]),c([Oe,_e]));var g,v,p,j,x,m,y=(g=In(u),v=a,p=e.value,j=e.id,x=e.speaker,m=e.tags,{type:"option",name:p,mode:v,content:g,id:j,speaker:x,tags:m});return n?(r.content=y,n):y},k=function(){for(var e,n;t.token===Re;){if(e){var r=D();n.content=r,n=r}else n=e=D();l([Re])&&c([Re])}return{root:e,wrapper:n}},y=function(){c([Ce,Ae]);var e,n=t;switch(n.token){case Ce:e=Cn(n.value);break;case Ae:e=Cn("<parent>")}return l([hn])?(c([hn]),e):(l([_e])||l([Re])&&(c([Re]),e=_(e)),e)},w=function(){var e=function(e){return{type:"variations",mode:e,content:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]}}("cycle");if(l([Pe])){var n=c([Pe]);if(!zn.includes(n.value))throw new Error('Wrong variation mode set "'.concat(n.value,'". Valid modes: ').concat(zn.join(", "),"."));e.mode=n.value}for(;l([xe,Ne]);)if(l([xe]))c([xe]);else{c([Ne]);var t=!1;if(l([xe])&&(c([xe]),t=!0),e.content.push(In(s())),t){var r=e.content[e.content.length-1].content;"options"!==r[r.length-1].type&&c([Oe])}l([Oe])&&c([Oe])}return c([Ee]),e},_=function e(n){var t=l([tn,rn]),r=S();if(n){var a=n;return l([Re])&&(c([Re]),a=e(n)),l([hn])&&c([hn]),t&&t.token!==an?Bn(r,a):Nn(r,a)}return l([hn])?(c([hn]),r):l([_e])?r:l([Re])?(c([Re]),t?Bn(r,e()):Nn(r,e())):(c([Se,je]),t?Bn(r,d()):Nn(r,d()))},S=function(){return l([tn])?I():l([rn])?T():(l([an])&&c([an]),A())},D=function(){if(l([tn])){var e=I();return Bn(e)}if(l([rn])){var n=T();return Bn(n)}l([an])&&c([an]);var t=A();return Nn(t)},I=function(){c([tn]);for(var e=[P()];l([fn]);)c([fn]),e.push(P());return c([Ge]),function(e){return{type:"assignments",assignments:e}}(e)},T=function(){c([rn]),c([nn]);for(var e=[Mn(t.value)];l([fn]);)c([fn]),c([nn]),e.push(Mn(t.value));return c([Ge]),function(e){return{type:"events",events:e}}(e)},C=function(){var e,n=A();return l([Ce,Ae])?e=y():l([hn])?(c([hn]),c([xe]),e=In(s()),c([Oe,_e])):l([Re])?(c([Re]),e=_()):(c([Se,je]),e=d(),l([Re])&&(c([Re]),e=_(e))),Nn(n,e)},A=function(){var e;return l([nn,Ue])&&(e=N()),c([Ge]),e},P=function e(){c([nn]);var n=An(t.value);if(l([Ge]))return n;var r=Object.keys(Gn);return c(r),l([nn])&&l([].concat(Object(E.a)(r),[Ge]),1)?Ln(n,Gn[t.token],e()):Ln(n,Gn[t.token],N())},N=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Object.keys(Rn),a=B();if(!l(r))return a;for(c(r);r.includes(t.token);){var i=t.token,o=Rn[t.token],u=o.precedence,s=o.associative;if(u<n)break;var d="LEFT"===s?u+1:u,b=e(d);a=V(i,a,b)}return a},B=function e(){switch(c([nn,Ue,Ye,en,Xe,Qe]),t.token){case Ue:return Vn("not",[e()]);case nn:return An(t.value);case Ye:return n=t.value,Pn("number",Number(n));case en:return function(e){return Pn("string",e)}(t.value);case Xe:return function(e){return Pn("boolean","true"===e)}(t.value);case Qe:return{type:"null"}}var n},V=function(e,n,t){var r,a=(r={},Object(g.a)(r,Be,"add"),Object(g.a)(r,Ne,"sub"),Object(g.a)(r,Ve,"mult"),Object(g.a)(r,Le,"div"),Object(g.a)(r,ze,"mod"),Object(g.a)(r,Me,"pow"),Object(g.a)(r,Fe,"and"),Object(g.a)(r,He,"or"),Object(g.a)(r,qe,"equal"),Object(g.a)(r,Ze,"not_equal"),Object(g.a)(r,Ke,"greater_than"),Object(g.a)(r,Je,"less_than"),Object(g.a)(r,$e,"greater_or_equal"),Object(g.a)(r,We,"less_or_equal"),r);return Vn(a[e],[n,t])},L=function(){var e=[_e,Se,je,me,ke,ye,Ce,Ae,we,Re],n=l();switch(n.token){case _e:return Dn();case Se:case je:case me:case ke:case ye:case Ce:case Ae:case we:case Re:case hn:var t=Dn([In(s())]);return l([Te])&&(t.blocks=u()),t;case Te:return Dn([],u());default:o(n,e)}}();return l()&&c([_e]),L}var Hn,Un,qn,Zn,$n,Wn,Kn,Jn=q.a.div(_n||(_n=Object(l.a)(["\n  text-align: center;\n  width: auto;\n  background-color: #eeeeee;\n  margin: 10px 10px;\n  padding: 10px 20px;\n  border-radius: 5px;\n  cursor: default;\n"]))),Yn=q.a.div(Sn||(Sn=Object(l.a)(["\n  text-align: center;\n  width: auto;\n  background-color: #ffeeee;\n  margin: 10px 10px;\n  padding: 30px 20px;\n  border-radius: 5px;\n  cursor: default;\n  font-weight: 500;\n  display: flex;\n  justify-content: center;\n  white-space: pre-line;\n  line-height: 26px;\n"]))),Qn=q.a.div(Hn||(Hn=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  color: #444;\n  padding: 0px 10px;\n  height: 40px;\n\n  > svg {\n    cursor: pointer;\n    font-size: 1.5em;\n    margin: 0px 20px;\n    &:hover {\n      color: #555;\n    }\n  }\n"])));function Xn(e){var n=e.doc,t=e.currentBlock,r=e.shouldShowExtraMetadata,a=e.shouldShowDebugPane,i=e.singleBubblePresentation,o=e.setBlock,c=e.clearTimeline,l=e.showExtraMetadata,u=e.hideExtraMetadata,s=e.showDebugPane,d=e.hideDebugPane,b=e.enableSingleBubbleDialogue,f=e.disableSingleBubbleDialogue,h=e.dialogue,g=e.addDialogueLine,v=e.chooseOption,p=e.clearEvents,j=function e(){var n=h.getContent();return g(n),n&&"options"!==n.type?e():n};return Object(W.jsxs)(Qn,{children:[Object(W.jsx)(et,{document:n,currentBlock:t,onBlockSelected:function(e){o(e),c(),h.start(e)}}),Object(W.jsx)(Z.a,{icon:$.l,title:"Restart dialogue",onClick:function(){h.start(t),c()}}),Object(W.jsx)(Z.a,{icon:$.h,title:"Forward untill next choice",onClick:j}),Object(W.jsx)(Z.a,{icon:$.i,title:"Execute Poltergeist mode (auto anwser)",onClick:function e(){var n=j();if(n){var t=Math.floor(Math.random()*n.options.length);v(t),h.choose(t),e()}}}),Object(W.jsx)(Z.a,{icon:$.j,title:"Clear memory",onClick:function(){h.clearData(),g({type:"INTERPRETER_INFO",text:"Memory cleared"}),h.start(t),p(),c()}}),Object(W.jsx)(Z.a,{icon:i?$.f:$.e,title:"Set ".concat(i?"multi":"single"," bubble dialogue"),onClick:function(){i?f():b()}}),Object(W.jsx)(Z.a,{icon:$.k,onClick:function(){r?u():l()},title:"".concat(r?"Hide":"Show"," metadata")}),Object(W.jsx)(Z.a,{icon:$.a,onClick:function(){a?d():s()},title:"".concat(a?"Hide":"Show"," debug pane")})]})}function et(e){var n=e.document,t=e.currentBlock,r=e.onBlockSelected,a=[].concat(Object(E.a)(n.content.length>0?["default"]:[]),Object(E.a)(n.blocks.map((function(e){return e.name}))));return Object(W.jsx)("div",{children:Object(W.jsx)("select",{value:t,onChange:function(e){"default"!==e.target.value?r(e.target.value):r()},"aria-label":"Block selector",children:a.map((function(e,n){return Object(W.jsx)("option",{value:e,children:e},n)}))})})}var nt,tt=q.a.div(Un||(Un=Object(l.a)(["\n  width: auto;\n  background-color: #fff5da;\n  color: #34383c;\n  margin: 10px 10px;\n  padding: 10px 20px;\n  border-radius: 5px;\n  cursor: default;\n  position: relative;\n"]))),rt=q.a.div(qn||(qn=Object(l.a)(["\n"]))),at=q.a.div(Zn||(Zn=Object(l.a)(["\n  margin-bottom: 5px;\n  font-weight: 500;\n"]))),it=q.a.ol($n||($n=Object(l.a)(["\n  margin-left: 10px;\n  list-style-type: decimal;\n  list-style-position: inside;\n"]))),ot=q.a.li(Wn||(Wn=Object(l.a)(["\n  position: relative;\n  opacity: ",";\n  ","\n  cursor: ",";\n  margin: 4px;\n\n  > span:hover {\n    ","\n  }\n"])),(function(e){return void 0!==e.optionSelected&&e.optionSelected!==e.index?.5:1}),(function(e){return e.optionSelected===e.index?"font-weight: 600;":""}),(function(e){return void 0===e.optionSelected?"pointer":"default"}),(function(e){return void 0!==e.optionSelected?"":"font-weight: 600;"})),ct=q.a.span(Kn||(Kn=Object(l.a)(["\n  color: #444;\n  font-weight: normal;\n  background-color: rgba(245,235,208, 1);\n  opacity: 0.8;\n  border-radius: 5px;\n  padding-right: 10px;\n  margin-left: 10px;\n\n  label {\n    margin-left: 10px;\n    font-weight: 500;\n  }\n"])));function lt(e){var n=e.line,t=e.onSelection,r=e.showMetadata;return void 0===n?Object(W.jsx)(Jn,{children:"DIALOGUE ENDED"}):"line"===n.type?Object(W.jsx)(ut,Object(u.a)(Object(u.a)({},n),{},{showMetadata:r})):"options"===n.type?Object(W.jsx)(st,Object(u.a)(Object(u.a)({},n),{},{onSelection:t,showMetadata:r})):Object(W.jsx)(Jn,{children:"<DIALOGUE_CHANGED>"===n.text?"DIALOGUE CHANGED":n.text})}function ut(e){var n=e.id,t=e.tags,r=e.speaker,a=e.text,i=e.showMetadata;return Object(W.jsxs)(tt,{children:[r?Object(W.jsx)(at,{children:r}):void 0,Object(W.jsxs)(rt,{children:[a," ",Object(W.jsx)(dt,{id:n,tags:t,isVisible:i})]})]})}function st(e){var n=e.id,t=e.tags,r=e.speaker,a=e.name,i=e.options,o=e.onSelection,c=e.selected,l=e.showMetadata;return Object(W.jsxs)(tt,{children:[r?Object(W.jsx)(at,{children:r}):void 0,Object(W.jsxs)(rt,{children:[a," ",Object(W.jsx)(dt,{id:n,tags:t,isVisible:l}),Object(W.jsx)(it,{children:i.map((function(e,n){return Object(W.jsx)(ot,{optionSelected:c,index:n,children:Object(W.jsxs)("span",{onClick:function(e){e.stopPropagation(),function(e){void 0===c&&o(e)}(n)},children:[e.label," ",Object(W.jsx)(dt,Object(u.a)(Object(u.a)({},e),{},{isVisible:l}))]})},n)}))})]})]})}function dt(e){var n=e.id,t=e.tags;return!e.isVisible||void 0===n&&void 0===t?Object(W.jsx)("span",{}):Object(W.jsxs)(ct,{"aria-label":"metadata",children:[void 0!==n?Object(W.jsxs)("span",{"aria-label":"line id",children:[Object(W.jsx)("label",{children:"id:"})," ",n]}):void 0," ",void 0!==t?Object(W.jsxs)("span",{"aria-label":"line tags",children:[Object(W.jsx)("label",{children:"tags:"})," ",t.join(", ")]}):void 0]})}var bt=q.a.div(nt||(nt=Object(l.a)(["\n  width: auto;\n  overflow: scroll;\n"])));function ft(e){var n=e.timeline,t=e.shouldShowExtraMetadata,r=e.singleBubblePresentation,i=e.addDialogueLine,o=e.style,c=e.dialogue,l=e.chooseOption,u=function(){var e=c.getContent();e&&"options"===e.type&&n.length>0&&"options"===n[n.length-1].type||(e||n[n.length-1])&&i(e)},s=function(e){c.choose(e),l(e),u()},d=Object(a.useRef)(null);return Object(a.useEffect)((function(){d.current.scrollIntoView({behavior:"smooth"})}),[n]),Object(W.jsxs)(bt,{onClick:u,style:o,"aria-label":"Interpreter Dialogue Timeline",children:[n&&n.length?"":Object(W.jsx)(Jn,{children:"Dialogue not started. Click for next line."}),r?n.length?Object(W.jsx)(lt,{line:n[n.length-1],onSelection:s,showMetadata:t}):void 0:n.filter((function(e,t){var r;return!(e&&"<DIALOGUE_CHANGED>"===e.text&&e.text===(null===(r=n[t-1])||void 0===r?void 0:r.text))})).map((function(e,n){return Object(W.jsx)(lt,{line:e,onSelection:s,showMetadata:t},n)})),Object(W.jsx)("div",{ref:d})]})}var ht,gt,vt,pt=["events","hideDebugPane"],jt=q.a.div(ht||(ht=Object(l.a)(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  overflow: scroll;\n"]))),xt=q.a.div(gt||(gt=Object(l.a)(["\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  cursor: pointer;\n"]))),Ot=q.a.table(vt||(vt=Object(l.a)(["\n  width: 90%;\n  margin: 10px;\n\n  thead > tr > td {\n    font-weight: 500;\n    padding-bottom: 5px;\n  }\n\n  tbody {\n    > tr:nth-child(even) {\n      background-color: #f3f3f3;\n    }\n    td {\n      padding: 2px 0px;\n    }\n  }\n"])));function mt(e){var n=e.events,t=e.hideDebugPane,r=Object(te.a)(e,pt),a=n.reduce((function(e,n){var t="".concat(n.type).concat(n.data.name),r=e[t];return r?(r.eventTime=n.eventTime,n.data.value&&(r.value=n.data.value),e):(e[t]={type:n.type,name:n.data.name,value:n.data.value,eventTime:n.eventTime},e)}),{}),i=function(e){var n=new Date(e);return"".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate()," ").concat(n.toLocaleTimeString())};return Object(W.jsxs)(jt,Object(u.a)(Object(u.a)({"aria-label":"Debug pane"},r),{},{children:[Object(W.jsx)(xt,{children:Object(W.jsx)(Z.a,{icon:$.n,onClick:t,"aria-label":"Close debug pane"})}),Object(W.jsxs)(Ot,{children:[Object(W.jsx)("thead",{children:Object(W.jsxs)("tr",{children:[Object(W.jsx)("td",{children:"Type"}),Object(W.jsx)("td",{children:"Name"}),Object(W.jsx)("td",{children:"Value"}),Object(W.jsx)("td",{children:"Time"})]})}),Object(W.jsx)("tbody",{children:Object.keys(a).map((function(e){var n=a[e];return Object(W.jsxs)("tr",{children:[Object(W.jsx)("td",{children:n.type}),Object(W.jsx)("td",{children:n.name}),Object(W.jsx)("td",{children:void 0!==n.value?n.value.toString():void 0}),Object(W.jsx)("td",{children:i(n.eventTime)})]},e)}))})]})]}))}var kt,yt,wt,Et,_t,St,Dt,It=["content","currentBlock","timeline","shouldShowExtraMetadata","shouldShowDebugPane","debugPaneDirection","singleBubblePresentation","clydeDocument","setBlock","addDialogueLine","clearTimeline","showExtraMetadata","hideExtraMetadata","showDebugPane","hideDebugPane","enableSingleBubbleDialogue","disableSingleBubbleDialogue","chooseOption","notifyEvent","clearEvents","events"],Tt=q.a.div(kt||(kt=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"])));function Ct(e){var n,t,r=e.content,i=e.currentBlock,o=e.timeline,c=e.shouldShowExtraMetadata,l=e.shouldShowDebugPane,s=e.debugPaneDirection,d=void 0===s?"horizontal":s,b=e.singleBubblePresentation,f=(e.clydeDocument,e.setBlock),h=e.addDialogueLine,g=e.clearTimeline,v=e.showExtraMetadata,p=e.hideExtraMetadata,j=e.showDebugPane,x=e.hideDebugPane,O=e.enableSingleBubbleDialogue,m=e.disableSingleBubbleDialogue,k=e.chooseOption,y=e.notifyEvent,w=e.clearEvents,E=e.events,_=Object(te.a)(e,It),S=Object(a.useState)(""),D=Object(U.a)(S,2),I=D[0],T=D[1],C=Object(a.useState)(),A=Object(U.a)(C,2),P=A[0],N=A[1],B=P,V=function(e,n){y({type:e,data:n,eventTime:Date.now()})};try{n=Fn("".concat(r||"")),B&&r===I||(T(r),B=function(e,n){var t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={},i=pe(),o=he(i,n),c=be(o);e._index=1,e.blocks.forEach((function(e,n){e._index=n+2,a[e.name]=e}));var l=function(){t=[{current:arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,contentIndex:-1}]},u={document:function(){return h()},content:function(e){return g(e)},options:function(e){return O(e)},option:function(e){return m(e)},line:function(e){return y(e)},action_content:function(e){return w(e)},conditional_content:function(e,n){return _(e,n)},variations:function(e){return k(e)},block:function(e){return v(e)},divert:function(e){return p(e)},assignments:function(e){return j(e)},events:function(e){return x(e)},error:function(e){throw new Error('Unkown node type "'.concat(e.type,'"'))}},s={cycle:function(e){var n=o.getInternalVariable(e._index,-1);return n<e.content.length-1?n+=1:n=0,o.setInternalVariable(e._index,n),n},once:function(e){var n=o.getInternalVariable(e._index,-1)+1;return n<=e.content.length-1?(o.setInternalVariable(e._index,n),n):-1},sequence:function(e){var n=o.getInternalVariable(e._index,-1);return n<e.content.length-1&&(n+=1,o.setInternalVariable(e._index,n)),n},shuffle:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cycle",t="".concat(e._index,"_shuffle_visited"),r="".concat(e._index,"_last_index"),a=o.getInternalVariable(t,[]),i=e.content.filter((function(e){return!a.includes(e._index)}));if(0===i.length)return"once"===n?-1:"cycle"===n?(o.setInternalVariable(t,[]),s.shuffle(e,n)):o.getInternalVariable(r,-1);var c=Math.floor(Math.random()*i.length),l=e.content.indexOf(i[c]);return a.push(i[c]._index),o.setInternalVariable(r,l),o.setInternalVariable(t,a),l},"shuffle sequence":function(e){return s.shuffle(e,"sequence")},"shuffle once":function(e){return s.shuffle(e,"once")},"shuffle cycle":function(e){return s.shuffle(e,"cycle")}},d=function(e,n){return(u[e.type]||u.error)(e,n)},b=function(){return 10*D().current._index+D().contentIndex},f=function(e){D().current!==e&&t.push({current:e,contentIndex:-1})},h=function(){var e=D(),n=e.contentIndex+1;if(n<e.current.content.length)return e.contentIndex=n,d(e.current.content[n])},g=function(e){D().current!==e&&(e._index||(e._index=b()),t.push({current:e,contentIndex:-1}));var n=D(),r=n.contentIndex+1;return r<n.current.content.length?(n.contentIndex=r,d(n.current.content[r])):(t.pop(),d(D().current))},v=function(e){f(e);var n=D(),t=n.contentIndex+1;if(t<n.current.content.content.length)return n.contentIndex=t,d(n.current.content.content[t])},p=function(e){if("<parent>"===e.target){for(;!["document","block","option","options"].includes(D().current.type);)t.pop();if(t.length>1)return t.pop(),d(D().current)}else{if("<end>"!==e.target)return d(a[e.target]);l(),D().contentIndex=D().current.content.length}},j=function(e){return e.assignments.forEach(c.handleAssignement),d(D().current)},x=function(e){return e.events.forEach((function(e){i.triggerEvent(i.events.EVENT_TRIGGERED,{name:e.name})})),d(D().current)},O=function(e){e._index||(e._index=b(),o.setInternalVariable("OPTIONS_COUNT",e.content.length)),f(e);var n=I(e);return o.setInternalVariable("OPTIONS_COUNT",n.length),0===n.length?(t.pop(),d(D().current)):1===n.length&&"fallback"===n[0].mode?(S(0),d(D().current)):{type:"options",speaker:e.speaker,id:e.id,tags:e.tags,name:A(C(e.name,e.id)),options:n.map((function(e){return"action_content"===e.type?e.content:e})).map((function(e){return{label:A(C(e.name,e.id)),speaker:e.speaker,tags:e.tags,id:e.id}}))}},m=function(e){return t.pop(),t.pop(),d(D().current)},k=function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n._index||(n._index=b(),n.content.forEach((function(e,n){e._index=100*b()+n})));var r=s[n.mode](n);return-1===r||t>n.content.length?d(D().current):1!==n.content[r].content.length||"conditional_content"!==n.content[r].content[0].type||c.checkCondition(n.content[r].content[0].conditions)?d(n.content[r]):e(n,t+1)},y=function(e){return e._index||(e._index=b()),{type:"line",tags:e.tags,id:e.id,speaker:e.speaker,text:A(C(e.value,e.id))}},w=function(e){return E(e),d(e.content)},E=function(e){"events"===e.action.type?e.action.events.forEach((function(e){i.triggerEvent(i.events.EVENT_TRIGGERED,{name:e.name})})):e.action.assignments.forEach(c.handleAssignement)},_=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D().current;return c.checkCondition(e.conditions)?d(e.content):d(n)},S=function(e){var n=D();if("options"!==n.current.type)throw new Error("Nothing to select.");var t=I(n.current);if(e>=t.length)throw new Error("Index ".concat(e," not available."));o.setAsAccessed(t[e]._index),o.setInternalVariable("OPTIONS_COUNT",I(n.current).length),t[e].content._index=t[e]._index,"action_content"===t[e].type?(E(t[e]),f(t[e].content),f(t[e].content.content)):(f(t[e]),f(t[e].content))},D=function(){return t[t.length-1]},I=function(e){return e.content.map(T).filter((function(e){return e&&!("once"===e.mode&&o.wasAlreadyAccessed(e._index))}))},T=function e(n,t){if(n._index||(n._index=100*b()+t),"conditional_content"===n.type)return n.content._index=n._index,c.checkCondition(n.conditions)?e(n.content,t):void 0;if("action_content"===n.type){if(n.content._index=n._index,n.mode=n.content.mode,!e(n.content,t))return;return n}return n},C=function(e,n){return n&&r[n]?r[n]:e},A=function(e){return e&&(e.match(/\%([A-z0-9]*)\%/g)||[]).map((function(e){var n=e.replace(/\%/g,"");return{name:e,value:o.getVariable(n)}})).forEach((function(n){e=e.replace(n.name,void 0===n.value?"":n.value)})),e};return l(),{events:ve,on:function(e,n){return i.addListener(e,n)},off:function(e,n){i.removeListener(e,n)},getData:function(){return o.getAll()},loadData:function(e){o.load(e)},clearData:function(){o.clear()},loadDictionary:function(e){r=e},getContent:function(){return d(D().current)},choose:function(e){return S(e)},setVariable:function(e,n){o.setVariable(e,n)},getVariable:function(e){return o.getVariable(e)},start:function(e){e?l(a[e]):l()}}}(n),i&&(B.start(i),f(i)),N(B),B.on(B.events.VARIABLE_CHANGED,(function(e){V("variable",e)})),B.on(B.events.EVENT_TRIGGERED,(function(e){V("event",e)})))}catch(L){t=L.message,n=Fn("".concat(I||""))}return Object(W.jsxs)(Tt,Object(u.a)(Object(u.a)({},_),{},{"aria-label":"Clyde interpreter",children:[Object(W.jsx)(Xn,{doc:n,currentBlock:i,timeline:o,shouldShowExtraMetadata:c,shouldShowDebugPane:l,singleBubblePresentation:b,setBlock:f,clearTimeline:g,showExtraMetadata:v,hideExtraMetadata:p,showDebugPane:j,hideDebugPane:x,enableSingleBubbleDialogue:O,disableSingleBubbleDialogue:m,addDialogueLine:h,dialogue:B,chooseOption:k,clearEvents:w}),Object(W.jsxs)(Y,{direction:d,defaultSizes:[80,20],style:{height:"calc(100% - 40px)"},children:[!t&&r&&""!==r?Object(W.jsx)(ft,{dialogue:B,currentBlock:i,timeline:o,shouldShowExtraMetadata:c,singleBubblePresentation:b,setBlock:f,addDialogueLine:h,clearTimeline:g,chooseOption:k}):t?Object(W.jsx)(Yn,{style:{backgroundColor:"#eeefef"},children:t}):Object(W.jsx)(Jn,{children:"Nothing to show."}),l?Object(W.jsx)(mt,{events:E,hideDebugPane:x}):void 0]})]}))}var At,Pt=q.a.div(yt||(yt=Object(l.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n"]))),Nt=q.a.div(wt||(wt=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  min-width: 500px;\n  min-height: 300px;\n  color: #333;\n  padding: 10px;\n"]))),Bt=q.a.div(Et||(Et=Object(l.a)(["\n  margin-bottom: 10px;\n  padding-bottom: 10px;\n  text-align: center;\n  border-bottom: 1px solid #ccc;\n"]))),Vt=q.a.div(_t||(_t=Object(l.a)(["\n  text-align: right;\n"]))),Lt=q.a.div(St||(St=Object(l.a)(["\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n"]))),Mt=q.a.button(Dt||(Dt=Object(l.a)(["\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  padding: 8px 12px;\n\n  &:focus, &:hover {\n    background-color: #f1f1f1;\n  }\n"])));function zt(e){var n=e.title,t=e.actions,r=e.children;return Object(W.jsx)(Pt,{children:Object(W.jsxs)(Nt,{children:[Object(W.jsx)(Bt,{children:n}),Object(W.jsx)(Lt,{children:r}),Object(W.jsx)(Vt,{children:t.map((function(e,n){return Object(W.jsx)(Mt,{onClick:e.onClick,children:e.label},n)}))})]})})}var Rt,Gt,Ft,Ht=q.a.div(At||(At=Object(l.a)(['\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 4px 10px;\n\n  > input {\n    margin-right: 10px;\n  }\n\n  > select, > input[type="number"] {\n    margin-left: 10px;\n  }\n'])));function Ut(e){var n=e.onCloseClick,t=e.updatePreference,r=e.preferences,a=function(e){t(e.target.name,e.target.checked)},i=function(e){t(e.target.name,Number(e.target.value))};return Object(W.jsxs)(zt,{title:"Editor preferences",actions:[{label:"Close",onClick:function(){return n()}}],children:[Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"highlightActiveLine",onChange:a,checked:r.highlightActiveLine}),Object(W.jsx)("label",{htmlFor:"highlightActiveLine",children:"Highlight active line"})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"showInvisibles",onChange:a,checked:r.showInvisibles}),Object(W.jsx)("label",{htmlFor:"showInvisibles",children:"Show invisibles"})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"vimMode",onChange:a,checked:r.vimMode}),Object(W.jsx)("label",{htmlFor:"vimMode",children:"Enable vim mode"})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"lineWrap",onChange:a,checked:r.lineWrap}),Object(W.jsx)("label",{htmlFor:"line_wrap",children:"Enable line wrap"})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"scrollPastEnd",onChange:a,checked:r.scrollPastEnd}),Object(W.jsx)("label",{htmlFor:"scrollPastEnd"})," Enable scroll past end"]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("input",{type:"checkBox",name:"useSoftTabs",onChange:a,checked:r.useSoftTabs}),Object(W.jsx)("label",{htmlFor:"useSoftTabs",children:"Enable soft tabs"})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("label",{htmlFor:"tabSize",children:"Tab size"}),Object(W.jsx)("input",{type:"number",name:"tabSize",max:"10",min:"1",onChange:i,value:r.tabSize})]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("label",{htmlFor:"fontSize",children:"Font size"}),Object(W.jsx)("input",{type:"number",name:"fontSize",max:"70",min:"1",onChange:i,value:r.fontSize}),"px"]}),Object(W.jsxs)(Ht,{children:[Object(W.jsx)("label",{htmlFor:"theme",children:"Theme"}),Object(W.jsx)("select",{name:"theme",value:r.theme,onChange:function(e){t(e.target.name,e.target.value)},children:[{value:"dracula",name:"Dracula"},{value:"monokai",name:"Monokai"},{value:"tomorrow_night_eighties",name:"Tomorrow Night Eighties"},{value:"tomorrow",name:"Tomorrow"},{value:"textmate",name:"Textmate"}].map((function(e,n){return Object(W.jsx)("option",{value:e.value,children:e.name},n)}))})]})]})}var qt=q.a.div(Rt||(Rt=Object(l.a)(["\n  height: 100%;\n  max-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n"]))),Zt=q.a.div(Gt||(Gt=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  height: 40px;\n  font-size: 1.5em;\n  color: #444;\n  padding-left: 10px;\n  align-items: center;\n"]))),$t=q.a.span(Ft||(Ft=Object(l.a)(["\n  cursor: pointer;\n  position: relative;\n"])));var Wt=Object(d.b)((function(e,n){return Object(u.a)(Object(u.a)(Object(u.a)({},e.interfaceConfig),{},{editorDefaultValue:e.editor.currentValue,editorPreferences:e.editor.preferences},e.interpreter),n)}),(function(e){return{toggleEditor:function(n){e(v({state:n}))},toggleInterpreter:function(n){e(p({state:n}))},changeInterpreterSplitDirection:function(n){e(j({direction:n}))},setBlock:function(n){e(_(n))},addDialogueLine:function(n){e(S(n))},clearTimeline:function(){e(D())},showExtraMetadata:function(){e(I())},hideExtraMetadata:function(){e(T())},showDebugPane:function(){e(C())},hideDebugPane:function(){e(A())},enableSingleBubbleDialogue:function(){e(P())},disableSingleBubbleDialogue:function(){e(N())},chooseOption:function(n){e(B(n))},setDocumentContent:function(n){e(m(n))},notifyEvent:function(n){e(V(n))},clearEvents:function(){e(L())},updateEditorPreference:function(n,t){e(k({name:n,value:t}))}}}))((function(e){var n=e.isEditorEnabled,t=void 0===n||n,r=e.isInterpreterEnabled,i=void 0===r||r,o=e.toggleEditor,c=e.toggleInterpreter,l=e.interpreterSplitDirection,u=void 0===l?"horizontal":l,s=e.changeInterpreterSplitDirection,d=e.editorDefaultValue,b=e.setDocumentContent,f=e.editorPreferences,h=e.updateEditorPreference,g=e.currentBlock,v=e.timeline,p=e.shouldShowExtraMetadata,j=e.shouldShowDebugPane,x=e.singleBubblePresentation,O=e.document,m=e.setBlock,k=e.addDialogueLine,y=e.clearTimeline,w=e.showExtraMetadata,E=e.hideExtraMetadata,_=e.showDebugPane,S=e.hideDebugPane,D=e.enableSingleBubbleDialogue,I=e.disableSingleBubbleDialogue,T=e.chooseOption,C=e.events,A=e.notifyEvent,P=e.clearEvents,N=Object(a.useState)(!1),B=Object(U.a)(N,2),V=B[0],L=B[1],M=Object(a.useState)(!1),z=Object(U.a)(M,2),R=z[0],G=z[1],F=function(){L(!V)};return Object(W.jsxs)(qt,{children:[Object(W.jsx)(Zt,{children:Object(W.jsxs)($t,{children:[Object(W.jsx)(Z.a,{icon:$.c,onClick:F,"aria-label":"Toggle settings menu"}),V?Object(W.jsxs)(ee,{onClick:F,children:[Object(W.jsx)(ne,{label:"Change split direction",onClick:function(){s("vertical"===u?"horizontal":"vertical")},icon:$.d,text:"Split mode: ".concat(u)}),i?Object(W.jsx)(ne,{label:"Toggle editor",onClick:function(){return o(!t)},icon:$.b,text:"".concat(t?"Hide":"Show"," editor")}):void 0,t?Object(W.jsx)(ne,{label:"Toggle interpreter",onClick:function(){return c(!i)},icon:$.g,text:"".concat(i?"Hide":"Show"," interpreter")}):void 0,Object(W.jsx)(ne,{label:"Editor preferences",onClick:function(){G(!0)},icon:$.m,text:"Editor preferences"})]}):""]})}),Object(W.jsxs)(Y,{direction:u,defaultSizes:[50,50],style:{height:"calc(100% - 40px)"},"aria-label":"Main panels",children:[t?Object(W.jsx)(de,{defaultValue:d,setDocumentContent:b,notifyChange:k,preferences:f}):void 0,i?Object(W.jsx)(Ct,{content:d,currentBlock:g,timeline:v,shouldShowExtraMetadata:p,shouldShowDebugPane:j,singleBubblePresentation:x,clydeDocument:O,setBlock:m,addDialogueLine:k,clearTimeline:y,showExtraMetadata:w,hideExtraMetadata:E,showDebugPane:_,hideDebugPane:S,enableSingleBubbleDialogue:D,disableSingleBubbleDialogue:I,chooseOption:T,events:C,notifyEvent:A,clearEvents:P}):void 0]}),R?Object(W.jsx)(Ut,{updatePreference:h,preferences:f,onCloseClick:function(){return G(!1)}}):void 0]})})),Kt="clyde_editor_data",Jt=Object(s.a)({reducer:H,devTools:!1,preloadedState:function(){var e=function(){try{var e=localStorage.getItem(Kt);if(null===e)return;return JSON.parse(e)}catch(n){return}}()||{editor:{currentValue:"",preferences:{theme:"dracula",fontSize:16,tabSize:4,highlightActiveLine:!1,lineWrap:!1,useSoftTabs:!0,showInvisibles:!1,scrollPastEnd:!1,vimMode:!1}}};return e.editor.currentValue||(e.editor.currentValue="--\n--\n-- This is a sample dialogue.\n--\n\nNarrator: Hello there!\nPlayer: Hi!\nNarrator: What do you want to talk about?\n  + Life\n    -> about life <-\n  + The universe\n    -> about the universe <-\n  * Everything else... #some_tag\n    -> about everything else <-\n  + Earth\n    -> about earth <-\n  + Nothing\n    -> goodbye <-\n\n\n== about life\nPlayer: I want to talk about life!\nNarrator: Well! That's complicated...\n<-\n\n\n== about the universe\nPlayer: I want to talk about the universe!\n( shuffle\n  - Narrator: That's too complex!\n  - Narrator: Maybe another time.\n  - Narrator: It's big...\n              I think that's all.\n)\n<-\n\n\n== about everything else\nPlayer: What about everything else?\nNarrator: I don't have time for this... #bored\n<-\n\n== about earth\nPlayer: What do you know about earth?\n( sequence\n - Narrator: It's mostly harmless.\n - Narrator: This again?\n             I've already told you, mostly harmless.\n -\n   Narrator: Why do you want to know so much about it?\n   Player: I don't know...\n   Narrator: So.. don't ask!\n\n - Narrator: I'm not talking about this anymore.\n)\n<-\n\n== goodbye\n{ not alreadyIntroduced }\n  Narrator: It was nice to meet you!\n  Player: I can say the same. See you around!\n  { set alreadyIntroduced = true }\nPlayer: Bye!\nNarrator: Good bye!\n"),{editor:e.editor,interpreter:Object(u.a)({document:void 0,events:[],timeline:[]},e.interpreter)}}()});Jt.subscribe(f()((function(){var e=Jt.getState(),n=e.interpreter,t=n.shouldShowExtraMetadata,r=n.shouldShowDebugPane,a=n.debugPaneDirection,i=n.singleBubblePresentation;!function(e){try{localStorage.setItem(Kt,JSON.stringify(e))}catch(n){}}({editor:{preferences:e.editor.preferences,currentValue:e.editor.currentValue},interpreter:{shouldShowExtraMetadata:t,shouldShowDebugPane:r,debugPaneDirection:a,singleBubblePresentation:i}})}),1e3));var Yt,Qt,Xt,er,nr=function(){return Object(W.jsx)(d.a,{store:Jt,children:Object(W.jsx)(Wt,{})})},tr=q.a.div(Yt||(Yt=Object(l.a)(["\n  height: 100%;\n  max-height: 100vh;\n  max-width: 1200px;\n  display: flex;\n  flex-direction: column;\n  padding: 10px 5px;\n  margin: 0 auto;\n"]))),rr=q.a.h1(Qt||(Qt=Object(l.a)(["\n  font-size: 2em;\n  font-weight: 500;\n"]))),ar=q.a.div(Xt||(Xt=Object(l.a)(["\n  font-family: 'Lato', sans-serif;\n  margin: 10px 40px;\n  p {\n    margin-bottom: 10px;\n  }\n\n  a {\n    margin: 5px 10px;\n  }\n"]))),ir=q.a.div(er||(er=Object(l.a)(["\n  margin-top: 30px;\n"])));function or(){return Object(W.jsxs)(tr,{children:[Object(W.jsxs)(ar,{children:[Object(W.jsx)(rr,{children:"Clyde Dialogue Language"}),Object(W.jsx)(ir,{children:Object(W.jsxs)("p",{children:["Clyde is a language for writing dialogues.",Object(W.jsx)("a",{href:"https://github.com/viniciusgerevini/clyde",children:"Github"}),Object(W.jsx)("a",{href:"https://github.com/viniciusgerevini/clyde/blob/master/LANGUAGE.md",children:"Language Docs"}),Object(W.jsx)("a",{href:"https://github.com/viniciusgerevini/clyde/tree/master/cli",children:"CLI"}),Object(W.jsx)("a",{href:"https://github.com/viniciusgerevini/godot-clyde-dialogue",children:"Godot Plugin"})]})})]}),Object(W.jsx)(nr,{})]})}c.a.render(Object(W.jsx)(i.a.StrictMode,{children:Object(W.jsx)(or,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.248340bc.chunk.js.map